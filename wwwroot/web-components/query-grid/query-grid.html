<link rel="stylesheet" href="query-grid.css" />

<header>
    <div class="controls">
        <dom-if if="[[hasGrouping]]">
            <template>
                <vi-query-grid-grouping query="[[query]]"></vi-query-grid-grouping>
            </template>
        </dom-if>
        <dom-if if="[[canSelect]]">
            <template>
                <vi-query-grid-select-all query="[[query]]"></vi-query-grid-select-all>
            </template>
        </dom-if>
        <dom-if if="[[canFilter]]">
            <template>
                <vi-query-grid-filters query="[[query]]"></vi-query-grid-filters>
            </template>
        </dom-if>
        <div class="spacer"></div>
    </div>
    <div>
        <div grid>
            <dom-repeat items="[[columns]]" as="column">
                <template>
                    <vi-query-grid-column-header column="[[column]]"></vi-query-grid-column-header>
                </template>
            </dom-repeat>
        </div>
    </div>
</header>

<vi-scroller horizontal-scroll-offset="{{horizontalScrollOffset}}" vertical-scroll-offset="{{verticalScrollOffset}}" outer-height="{{viewportHeight}}" outer-width="{{viewportWidth}}">
    <div id="gridWrapper">
        <div id="grid" grid$="[[initializing]]">
            <dom-repeat items="[[virtualItems]]">
                <template>
                    <vi-query-grid-row item="[[item]]" columns="[[columns]]" offsets="[[_computeOffsets(columnWidths)]]" visible-range="{{_computeVisibleRange(viewportWidth, horizontalScrollOffset)}}" initializing$="[[initializing]]"></vi-query-grid-row>
                </template>
            </dom-repeat>
        </div>
    </div>
</vi-scroller>

<dom-if if="[[query.totalItem]]">
    <template>
        <footer>
            <vi-query-grid-footer item="[[query.totalItem]]" columns="[[columns]]"></vi-query-grid-footer>
        </footer>
    </template>
</dom-if>

<vi-spinner hidden$="[[!query.isBusy]]"></vi-spinner>